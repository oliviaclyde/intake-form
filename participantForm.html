<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
       
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <title>contactUs</title>
    </head>
    <body>
        <h1>Contact Us</h1>
        <form name="newParticipant" id="newForm" onsubmit="handleFormSubmit()" method="POST">
            <ul>
                <li>
                    <label for="name">Name:</label>
                    <input type="text" id="name" name="userName">
                </li>
                <li>
                    <label for="mail">Email:</label>
                    <input type="email" id="mail" name="userEmail">
                </li>
                <li>
                    <label for="birthdate">Birth date:</label>
                    <input type="date" id="birthdate" name="userBirthdate">
                </li>
            </ul>
            <input type="checkbox" id="chkAgreement" name="checkbox" value="agree"/>
            <label for="chkAgreement">I agree to be contacted via email!</label> 
                          
            <ul>
            <ul class="button">
                <button type="submit">Submit</button>
            </ul>
            <ul class="button">
                <button type="clear" id="reset">Clear</button>
            </ul>
        </form>    
        
        


    <!-- JavaScript -->
    <script type="text/JavaScript">
        function validateName() {
            var name = document.forms["newParticipant"]["userName"];
            if (name.value == "") {
                alert("Please enter your name.");
                name.focus();
                return false;
                
                }
        };

        function validateEmailNotBlank() {
            var email = document.forms["newParticipant"]["userEmail"]
            if (email.value == "") {
                alert("Please provide your email address.");
                email.focus();
                return false;
            }
        };

        function validateEmailVaildAddress() {
            var email = document.forms["newParticipant"]["userEmail"]
            atSign = email.indexOf("@");
            dot = email.lastIndexOf(".");
            
            if (atSign < 1 || (dot - atSign < 2)) {
                alert("Please enter a valid email address.")
                email.focus();
                return false;
            }
        };

        function validateBirthdate() {
            var birthdate = document.forms["newParticipant"]["userBirthdate"]
            var month = parseInt(birthdate.substring(0,2))
            var day = parseInt(birthdate.substring(3, 5))
            var year = parseInt(birthdate.substring(6))
            var currentTime = new Date();
            const thisYear = currentTime.getFullYear();

            if (month > 12) {
                alert("Please enter a valid birthdate.")
                email.focus();
                return false;
            }

            if (day) {
                
            }
                 
           if (year < 1900 || year > thisYear) {
               return false;
           }     
        };

        function validateCheckBox() {
            var checkbox = document.forms["newParticipant"]["checkbox"]
            if (checkbox.checked == false) {
                alert("You must agree to be contacted.")
                return false;
            } else {
                return true;
            }
        };

        function successMessage() {
            alert("Thank you! The form has been sumbitted.")
        }
        
        document.getElementById("reset").onclick = function() {
            document.getElementById("name").value = "";
            document.getElementByID("mail").value = "";
            document.getElementByID("birthdate").value = "";
            document.getElementByID("chkAgreement").value = "";
            
        };



        
        // const form = document.getElementsByName('newParticipant')[0];
        // form.addEventListener('submit', handleFormSubmit);
        
        
        // function handleFormSubmit() {
        //     console.log('Olivia');
        //     // const data = {};
        //     // var formData = JSON.stringify(document.getElementsByName("newParticipant")[0]);
        //     var formData = $('#newForm').serialize();
        //     // console.log(formData);
        //     try {
        //         JSON.parse(formData);
        //         console.log('true');
        //     } catch (e) {
        //         console.log('False');
        //     }
        //     this.sendData(formData,"http://localhost:3000/");
        // };

        // function sendData(formData, url) {
        //     $.ajax({
        //     type: "POST",
        //     url: url,
        //     data: formData,
        //     success: function(){},
        //     dataType: "json",
        //     contentType : "application/json"
        //     });
        // }

        var seralizeForm = function (form) {
            var obj = {};
            var formData = new FormData(form);
            for (var key of formData.keys()) {
                obj[key] = formData.get(key);
            }
            return obj;
        };

        document.addEventListener('submit', function (event) {

            event.preventDefault();
            data: {'test', 'testing'}
            fetch('http://localhost:3000/', {
                method: 'POST',
                body: JSON.stringify(Object.fromEntries(new FormData(event.target))),
                // body: JSON.stringify(formData),
                headers: {
                'Content-type': 'application/json'
                }
            }).then(function (response) {
                if (response.ok) {
                    return response.json();
                }
                return Promise.reject(response);
            }).then(function (data) {
                console.log(data);
            }).catch(function (error) {
                console.warn(error);
            });
        });

        
    </script>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    </body>
</html>



<!-- Validate birthdate -->
<!-- Add id field to form when making POST request -->
 <!-- Submit button functionality - won't work if any fields are invalid -->
 <!-- Clear button mock up -->
<!-- Debug bootstrap styling -->
<!-- Write function to convert form data to JSON object for POST request -->


